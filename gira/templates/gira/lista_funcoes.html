{% extends 'gira/base.html' %}

{% block content %}
<div class="container my-4">

  {% if gira %}
    <div class="mb-4 text-start">
      <p class="mb-1" style="color: #8fc9ff; font-size: 0.95rem;">
        {{ gira.data_hora|date:"d/m/Y H:i" }}
      </p>
      <h2 style="color: #ccc; font-size: 1.6rem; font-weight: 600;">
        {{ gira.linha }}
      </h2>
      <p style="color: #ddd; font-size: 0.9rem;">
        Escolha ou visualize as funções assumidas para esta gira. 
        Cambones e responsáveis de cada área estão listados abaixo.
      </p>
    </div>
  {% else %}
    <div class="alert alert-warning">Nenhuma gira encontrada.</div>
  {% endif %}

  <hr class="my-4" style="border-top: 1px solid rgba(255,255,255,0.15);">

  <!-- BLOCO: CAMBONES -->
  <section class="mb-5">
    <h4 style="color: #ccc; font-size: 1.2rem; font-weight: 600;">Cambones</h4>
    {% if cambones %}
      <div class="row g-3">
        {% for f in cambones %}
          <div class="col-6 col-md-4 col-lg-3">
            <div class="card h-100 border-0" 
                 style="background: linear-gradient(145deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02)); border-radius: 12px;">
              <div class="card-body p-3 text-start">
                <div class="fw-semibold" style="color: #f8f8f8; font-size: 0.95rem;">
                  {{ f.medium_de_linha.nome|default:"—" }}
                </div>
                <div style="color: #b5b5b5; font-size: 0.85rem;">
                  {{ f.pessoa.nome|default:"—" }}
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p style="color: #aaa; font-style: italic;">Nenhum cambone cadastrado.</p>
    {% endif %}
  </section>

  <hr class="my-4" style="border-top: 1px solid rgba(255,255,255,0.15);">

  <!-- ORGANIZAÇÃO -->
  <section class="mb-5">
    <h4 style="color: #ccc; font-size: 1.2rem; font-weight: 600;">Organização</h4>
    {% if organizacao %}
     {% for nome in ordem_organizacao %}
        <div class="mb-3">
          <h6 style="color: #aaa; font-weight: 600;">{{ nome }}</h6>
          <div class="row g-3">
            {% for f in organizacao %}
              {% if f.descricao == nome %}
                <div class="col-6 col-md-4 col-lg-3">
                  <div class="card h-100 border-0 position-relative"
                       style="background: linear-gradient(145deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02)); border-radius: 12px;">
                    {% if f.status|lower == 'vaga' %}
                      <span class="badge bg-danger position-absolute" style="right:10px; top:10px; font-size:0.7rem;">Vago</span>
                    {% endif %}
                    <div class="card-body p-3 text-start">
                      <div class="fw-semibold" style="color: #f8f8f8; font-size: 0.95rem;">
                        {{ f.descricao }}
                      </div>
                      <div style="color: #b5b5b5; font-size: 0.85rem;">
                        {{ f.pessoa.nome|default:"-" }}
                      </div>
                    </div>
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>
      {% endfor %}
    {% endif %}
  </section>

  <hr class="my-4" style="border-top: 1px solid rgba(255,255,255,0.15);">

  <!-- LIMPEZA -->
  <section class="mb-5">
    <h4 style="color: #ccc; font-size: 1.2rem; font-weight: 600;">Limpeza</h4>
    {% if limpeza %}
      <div class="row g-3">
        {% for f in limpeza %}
          <div class="col-6 col-md-4 col-lg-3">
            <div class="card h-100 border-0 position-relative"
                 style="background: linear-gradient(145deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02)); border-radius: 12px;">
              {% if f.status|lower == 'vaga' %}
                <span class="badge bg-danger position-absolute" style="right:10px; top:10px; font-size:0.7rem;">Vago</span>
              {% endif %}
              <div class="card-body p-3 text-start">
                <div class="fw-semibold" style="color: #f8f8f8; font-size: 0.95rem;">
                  Limpeza
                </div>
                <div style="color: #b5b5b5; font-size: 0.85rem;">
                  {{ f.pessoa.nome|default:"-" }}
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  </section>

  <hr class="my-4" style="border-top: 1px solid rgba(255,255,255,0.15);">

  <!-- Rodapé -->
  <p style="color: #ddd; font-size: 0.9rem; text-align: justify;">
    Médiuns sem função definida na gira devem permanecer atentos, colaborar com os demais 
    e apoiar a assistência quando necessário.
  </p>

</div>
{% endblock %}
