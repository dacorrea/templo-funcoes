{% extends 'gira/base.html' %}

{% block content %}
<div class="container my-4">

  {% if gira %}
    <!-- Cabe√ßalho da Gira -->
    <div class="mb-4">
      <p class="text-info mb-1" style="font-size: 0.95rem;">
        {{ gira.data_hora|date:"d/m/Y H:i" }}
      </p>
      <h2 class="text-secondary mb-2" style="font-size: 1.6rem; font-weight: 600;">
        {{ gira.linha }}
      </h2>
      <p class="text-white-50" style="font-size: 0.95rem;">
        Escolha ou visualize as fun√ß√µes assumidas para esta gira. 
        Cambones e respons√°veis de cada √°rea est√£o listados abaixo.
      </p>
    </div>
  {% else %}
    <div class="alert alert-warning">Nenhuma gira encontrada.</div>
  {% endif %}

  <hr class="border-light my-4">

  <!-- BLOCO: CAMBONES -->
  <section class="mb-5">
    <h4 class="text-secondary mb-3" style="font-size: 1.3rem; font-weight: 600;">Cambones</h4>

    {% if cambones %}
      <div class="row g-3">
        {% for f in cambones %}
          <div class="col-6 col-md-4 col-lg-3">
            <!-- üîß bg-light-subtle -> bg-light para compatibilidade -->
            <div class="card border-0 shadow-sm bg-light h-100">
              <div class="card-body p-3 text-start">
                <div class="fw-semibold text-dark" style="font-size: 0.95rem;">
                  {{ f.medium_de_linha.nome|default:"‚Äî" }}
                </div>
                <div class="text-muted" style="font-size: 0.85rem;">
                  {{ f.pessoa.nome|default:"‚Äî" }}
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-muted fst-italic">Nenhum cambone cadastrado.</p>
    {% endif %}
  </section>

  <hr class="border-light my-4">

  <!-- BLOCO: ORGANIZA√á√ÉO -->
  <section class="mb-5">
    <h4 class="text-secondary mb-3" style="font-size: 1.3rem; font-weight: 600;">Organiza√ß√£o</h4>

    {% if organizacao %}
      <div class="row g-3">
        {% for f in organizacao %}
          <div class="col-6 col-md-4 col-lg-3">
            <div class="card border-0 shadow-sm bg-light h-100 position-relative">
              {% if f.status|lower == 'vaga' %}
                <span class="badge bg-danger position-absolute" 
                      style="right:10px; top:10px; font-size: 0.7rem;">Vago</span>
              {% endif %}
              <div class="card-body p-3 text-start">
                <div class="fw-semibold text-dark" style="font-size: 0.95rem;">
                  {{ f.descricao|default:f.tipo }}
                </div>
                <div class="text-muted" style="font-size: 0.85rem;">
                  {{ f.pessoa.nome|default:"-" }}
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-muted fst-italic">Nenhuma fun√ß√£o de organiza√ß√£o cadastrada.</p>
    {% endif %}
  </section>

  <hr class="border-light my-4">

  <!-- BLOCO: LIMPEZA -->
  <section class="mb-5">
    <h4 class="text-secondary mb-3" style="font-size: 1.3rem; font-weight: 600;">Limpeza</h4>

    {% if limpeza %}
      <div class="row g-3">
        {% for f in limpeza %}
          <div class="col-6 col-md-4 col-lg-3">
            <div class="card border-0 shadow-sm bg-light h-100 position-relative">
              {% if f.status|lower == 'vaga' %}
                <span class="badge bg-danger position-absolute" 
                      style="right:10px; top:10px; font-size: 0.7rem;">Vago</span>
              {% endif %}
              <div class="card-body p-3 text-start">
                <div class="fw-semibold text-dark" style="font-size: 0.95rem;">
                  {{ f.descricao|default:f.tipo }}
                </div>
                <div class="text-muted" style="font-size: 0.85rem;">
                  {{ f.pessoa.nome|default:"-" }}
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-muted fst-italic">Nenhuma fun√ß√£o de limpeza cadastrada.</p>
    {% endif %}
  </section>

  <hr class="border-light my-4">

  <!-- Rodap√© / Mensagem final -->
  <p class="text-white-50 mt-4" style="font-size: 0.9rem; text-align: justify;">
    M√©diuns sem fun√ß√£o definida na gira devem permanecer atentos, colaborar com os demais 
    e apoiar a assist√™ncia quando necess√°rio.
  </p>

</div>

<style>
.text-white-50 { color: rgba(255,255,255,0.7); }
.card .badge { font-size: 0.75rem; padding: 0.3rem 0.5rem; }
@media (max-width: 576px) {
  .card .badge { top: 8px; right: 8px; }
}
</style>

<!-- ‚úÖ Fechamento que estava faltando -->
{% endblock %}
